{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{setTutorialSeen}from'./api';// Helper: find element with retry\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";function findElement(selector){let attempts=arguments.length>1&&arguments[1]!==undefined?arguments[1]:12;let interval=arguments.length>2&&arguments[2]!==undefined?arguments[2]:120;return new Promise(resolve=>{let i=0;const tick=()=>{const el=document.querySelector(selector);if(el)return resolve(el);i+=1;if(i>=attempts)return resolve(null);setTimeout(tick,interval);};tick();});}export default function Tutorial(_ref){let{visible,onClose,token,setPage}=_ref;const[step,setStep]=useState(0);const[pointer,setPointer]=useState(null);// {top,left,width,height,placement}\nconst finishBtnRef=useRef(null);const interactiveSteps=[{title:'Welcome',body:'This quick interactive tour shows how to add and complete habits.'},{title:'Add a Habit',body:'Type a short habit name in this field.',selector:'.add-habit-input',placement:'right',page:'home'},{title:'Save the Habit',body:'Click the Add button to save your habit.',selector:'.add-habit-btn',placement:'bottom',page:'home'},{title:'Mark Complete',body:'Tap the mark-as-done button to record a completion for today.',selector:'.habit-complete-btn',placement:'left',page:'home'}];useEffect(()=>{if(visible){setStep(0);setPointer(null);document.body.style.overflow='hidden';setTimeout(()=>{var _finishBtnRef$current;return(_finishBtnRef$current=finishBtnRef.current)===null||_finishBtnRef$current===void 0?void 0:_finishBtnRef$current.focus();},120);return()=>{document.body.style.overflow='';};}},[visible]);// when step changes, if it has a selector, try to locate and position the pointer/highlight\nuseEffect(()=>{if(!visible)return;const s=interactiveSteps[step];let cancelled=false;(async()=>{setPointer(null);if(s!==null&&s!==void 0&&s.page&&setPage)setPage(s.page);if(!(s!==null&&s!==void 0&&s.selector))return;const el=await findElement(s.selector);if(!el||cancelled)return;// scroll into view then compute rect\nel.scrollIntoView({behavior:'smooth',block:'center',inline:'center'});await new Promise(r=>setTimeout(r,200));const rect=el.getBoundingClientRect();const pointerBox={top:rect.top+window.scrollY,left:rect.left+window.scrollX,width:rect.width,height:rect.height,placement:s.placement||'top'};setPointer(pointerBox);})();return()=>{cancelled=true;};},[step,visible]);if(!visible)return null;const steps=interactiveSteps;const finish=async()=>{try{localStorage.setItem('tutorialSeen','true');if(token){try{await setTutorialSeen(token);}catch(e){}}}catch(e){}onClose();};const s=steps[step];return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"tutorial-overlay\",role:\"dialog\",\"aria-modal\":\"true\",children:[pointer&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"tutorial-highlight\",style:{top:pointer.top-8,left:pointer.left-8,width:pointer.width+16,height:pointer.height+16}}),/*#__PURE__*/_jsx(\"div\",{className:\"tutorial-pointer tutorial-pointer-\".concat(pointer.placement),style:{top:pointer.placement==='bottom'?pointer.top+pointer.height+12:pointer.top-12,left:pointer.left+pointer.width/2},children:/*#__PURE__*/_jsx(\"div\",{className:\"tutorial-pointer-label\",children:s.title})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tutorial-card\",role:\"document\",style:{zIndex:13000},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tutorial-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tutorial-step\",children:[\"Step \",step+1,\" / \",steps.length]}),/*#__PURE__*/_jsx(\"button\",{className:\"tutorial-skip\",onClick:finish,children:\"Skip\"})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"tutorial-title\",children:s.title}),/*#__PURE__*/_jsx(\"p\",{className:\"tutorial-body\",children:s.body}),/*#__PURE__*/_jsxs(\"div\",{className:\"tutorial-actions\",children:[/*#__PURE__*/_jsx(\"button\",{disabled:step===0,onClick:()=>setStep(x=>Math.max(0,x-1)),children:\"Back\"}),step<steps.length-1?/*#__PURE__*/_jsx(\"button\",{onClick:()=>setStep(x=>Math.min(steps.length-1,x+1)),children:\"Next\"}):/*#__PURE__*/_jsx(\"button\",{ref:finishBtnRef,className:\"finish\",onClick:finish,children:\"Finish\"})]})]})]})});}","map":{"version":3,"names":["React","useState","useEffect","useRef","setTutorialSeen","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","findElement","selector","attempts","arguments","length","undefined","interval","Promise","resolve","i","tick","el","document","querySelector","setTimeout","Tutorial","_ref","visible","onClose","token","setPage","step","setStep","pointer","setPointer","finishBtnRef","interactiveSteps","title","body","placement","page","style","overflow","_finishBtnRef$current","current","focus","s","cancelled","scrollIntoView","behavior","block","inline","r","rect","getBoundingClientRect","pointerBox","top","window","scrollY","left","scrollX","width","height","steps","finish","localStorage","setItem","e","children","className","role","concat","zIndex","onClick","disabled","x","Math","max","min","ref"],"sources":["E:/New folder/New folder/frontend/src/Tutorial.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { setTutorialSeen } from './api';\r\n\r\n// Helper: find element with retry\r\nfunction findElement(selector, attempts = 12, interval = 120) {\r\n  return new Promise(resolve => {\r\n    let i = 0;\r\n    const tick = () => {\r\n      const el = document.querySelector(selector);\r\n      if (el) return resolve(el);\r\n      i += 1;\r\n      if (i >= attempts) return resolve(null);\r\n      setTimeout(tick, interval);\r\n    };\r\n    tick();\r\n  });\r\n}\r\n\r\nexport default function Tutorial({ visible, onClose, token, setPage }) {\r\n  const [step, setStep] = useState(0);\r\n  const [pointer, setPointer] = useState(null); // {top,left,width,height,placement}\r\n  const finishBtnRef = useRef(null);\r\n\r\n  const interactiveSteps = [\r\n    {\r\n      title: 'Welcome',\r\n      body: 'This quick interactive tour shows how to add and complete habits.'\r\n    },\r\n    {\r\n      title: 'Add a Habit',\r\n      body: 'Type a short habit name in this field.',\r\n      selector: '.add-habit-input',\r\n      placement: 'right',\r\n      page: 'home'\r\n    },\r\n    {\r\n      title: 'Save the Habit',\r\n      body: 'Click the Add button to save your habit.',\r\n      selector: '.add-habit-btn',\r\n      placement: 'bottom',\r\n      page: 'home'\r\n    },\r\n    {\r\n      title: 'Mark Complete',\r\n      body: 'Tap the mark-as-done button to record a completion for today.',\r\n      selector: '.habit-complete-btn',\r\n      placement: 'left',\r\n      page: 'home'\r\n    }\r\n  ];\r\n\r\n  useEffect(() => {\r\n    if (visible) {\r\n      setStep(0);\r\n      setPointer(null);\r\n      document.body.style.overflow = 'hidden';\r\n      setTimeout(() => finishBtnRef.current?.focus(), 120);\r\n      return () => { document.body.style.overflow = ''; };\r\n    }\r\n  }, [visible]);\r\n\r\n  // when step changes, if it has a selector, try to locate and position the pointer/highlight\r\n  useEffect(() => {\r\n    if (!visible) return;\r\n    const s = interactiveSteps[step];\r\n    let cancelled = false;\r\n\r\n    (async () => {\r\n      setPointer(null);\r\n      if (s?.page && setPage) setPage(s.page);\r\n      if (!s?.selector) return;\r\n      const el = await findElement(s.selector);\r\n      if (!el || cancelled) return;\r\n      // scroll into view then compute rect\r\n      el.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });\r\n      await new Promise(r => setTimeout(r, 200));\r\n      const rect = el.getBoundingClientRect();\r\n      const pointerBox = {\r\n        top: rect.top + window.scrollY,\r\n        left: rect.left + window.scrollX,\r\n        width: rect.width,\r\n        height: rect.height,\r\n        placement: s.placement || 'top'\r\n      };\r\n      setPointer(pointerBox);\r\n    })();\r\n\r\n    return () => { cancelled = true; };\r\n  }, [step, visible]);\r\n\r\n  if (!visible) return null;\r\n\r\n  const steps = interactiveSteps;\r\n\r\n  const finish = async () => {\r\n    try {\r\n      localStorage.setItem('tutorialSeen', 'true');\r\n      if (token) {\r\n        try { await setTutorialSeen(token); } catch (e) {}\r\n      }\r\n    } catch (e) {}\r\n    onClose();\r\n  };\r\n\r\n  const s = steps[step];\r\n\r\n  return (\r\n    <>\r\n      <div className=\"tutorial-overlay\" role=\"dialog\" aria-modal=\"true\">\r\n        {pointer && (\r\n          <>\r\n            <div\r\n              className=\"tutorial-highlight\"\r\n              style={{\r\n                top: pointer.top - 8,\r\n                left: pointer.left - 8,\r\n                width: pointer.width + 16,\r\n                height: pointer.height + 16\r\n              }}\r\n            />\r\n            <div\r\n              className={`tutorial-pointer tutorial-pointer-${pointer.placement}`}\r\n              style={{\r\n                top: (pointer.placement === 'bottom') ? (pointer.top + pointer.height + 12) : (pointer.top - 12),\r\n                left: pointer.left + pointer.width / 2\r\n              }}\r\n            >\r\n              <div className=\"tutorial-pointer-label\">{s.title}</div>\r\n            </div>\r\n          </>\r\n        )}\r\n\r\n        <div className=\"tutorial-card\" role=\"document\" style={{ zIndex: 13000 }}>\r\n          <div className=\"tutorial-header\">\r\n            <div className=\"tutorial-step\">Step {step + 1} / {steps.length}</div>\r\n            <button className=\"tutorial-skip\" onClick={finish}>Skip</button>\r\n          </div>\r\n          <h3 className=\"tutorial-title\">{s.title}</h3>\r\n          <p className=\"tutorial-body\">{s.body}</p>\r\n          <div className=\"tutorial-actions\">\r\n            <button disabled={step === 0} onClick={() => setStep(x => Math.max(0, x - 1))}>Back</button>\r\n            {step < steps.length - 1 ? (\r\n              <button onClick={() => setStep(x => Math.min(steps.length - 1, x + 1))}>Next</button>\r\n            ) : (\r\n              <button ref={finishBtnRef} className=\"finish\" onClick={finish}>Finish</button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}