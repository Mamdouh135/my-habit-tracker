{"ast":null,"code":"import React,{useState,useContext,useEffect}from'react';import{register,login}from'./api';import{AuthContext}from'./AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function LoginRegister(_ref){let{initial}=_ref;const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[isRegister,setIsRegister]=useState(false);const[error,setError]=useState('');const{login:doLogin}=useContext(AuthContext);useEffect(()=>{// allow hero CTA or App to pre-select the register/login tab via prop\nif(initial==='register')setIsRegister(true);if(initial==='login')setIsRegister(false);},[initial]);const handleSubmit=async e=>{e.preventDefault();setError('');try{if(isRegister){// Register then auto-login so the onboarding prompt shows immediately\nawait register(username,password);const res=await login(username,password);// clear any local tutorial state for a fresh new user and request auto-open\ntry{localStorage.removeItem('tutorialSeen');localStorage.setItem('autoOpenTutorial','true');}catch(err){}doLogin(res.data.token);// keep showing register=false view after auto-login isn't necessary\n}else{const res=await login(username,password);doLogin(res.data.token);}}catch(e){var _e$response,_e$response$data;setError(((_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.error)||'Error');}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:isRegister?'Register':'Login'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Username\",value:username,onChange:e=>setUsername(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Password\",type:\"password\",value:password,onChange:e=>setPassword(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:isRegister?'Register':'Login'})]}),/*#__PURE__*/_jsx(\"button\",{className:\"auth-toggle\",onClick:()=>setIsRegister(r=>!r),children:isRegister?'Have an account? Login':'No account? Register'}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error})]});}","map":{"version":3,"names":["React","useState","useContext","useEffect","register","login","AuthContext","jsx","_jsx","jsxs","_jsxs","LoginRegister","_ref","initial","username","setUsername","password","setPassword","isRegister","setIsRegister","error","setError","doLogin","handleSubmit","e","preventDefault","res","localStorage","removeItem","setItem","err","data","token","_e$response","_e$response$data","response","children","onSubmit","placeholder","value","onChange","target","type","className","onClick","r"],"sources":["E:/New folder/New folder/frontend/src/LoginRegister.js"],"sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\r\nimport { register, login } from './api';\r\nimport { AuthContext } from './AuthContext';\r\n\r\nexport default function LoginRegister({ initial }) {\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [isRegister, setIsRegister] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const { login: doLogin } = useContext(AuthContext);\r\n\r\n  useEffect(() => {\r\n    // allow hero CTA or App to pre-select the register/login tab via prop\r\n    if (initial === 'register') setIsRegister(true);\r\n    if (initial === 'login') setIsRegister(false);\r\n  }, [initial]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setError('');\r\n    try {\r\n      if (isRegister) {\r\n        // Register then auto-login so the onboarding prompt shows immediately\r\n        await register(username, password);\r\n        const res = await login(username, password);\r\n        // clear any local tutorial state for a fresh new user and request auto-open\r\n        try { localStorage.removeItem('tutorialSeen'); localStorage.setItem('autoOpenTutorial', 'true'); } catch (err) {}\r\n        doLogin(res.data.token);\r\n        // keep showing register=false view after auto-login isn't necessary\r\n      } else {\r\n        const res = await login(username, password);\r\n        doLogin(res.data.token);\r\n      }\r\n    } catch (e) {\r\n      setError(e.response?.data?.error || 'Error');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>{isRegister ? 'Register' : 'Login'}</h2>\r\n      <form onSubmit={handleSubmit}>\r\n        <input placeholder=\"Username\" value={username} onChange={e => setUsername(e.target.value)} />\r\n        <input placeholder=\"Password\" type=\"password\" value={password} onChange={e => setPassword(e.target.value)} />\r\n        <button type=\"submit\">{isRegister ? 'Register' : 'Login'}</button>\r\n      </form>\r\n      <button className=\"auth-toggle\" onClick={() => setIsRegister(r => !r)}>\r\n        {isRegister ? 'Have an account? Login' : 'No account? Register'}\r\n      </button>\r\n      {error && <div className=\"error\">{error}</div>}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}